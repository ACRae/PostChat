package isel.acrae.com

import isel.acrae.com.domain.Token
import isel.acrae.com.domain.makePhoneNumber
import isel.acrae.com.http.Routes
import isel.acrae.com.http.input.CreateUserInput
import isel.acrae.com.repository.TransactionManager
import isel.acrae.com.service.ServiceChat
import isel.acrae.com.service.ServiceHome
import isel.acrae.com.service.ServiceTemplate
import isel.acrae.com.service.ServiceUser
import org.jdbi.v3.core.Jdbi
import org.junit.jupiter.api.BeforeEach
import org.springframework.beans.factory.annotation.Autowired
import org.springframework.boot.test.autoconfigure.web.client.AutoConfigureWebClient
import org.springframework.boot.test.context.SpringBootTest
import org.springframework.http.HttpStatus
import org.springframework.http.ResponseCookie
import org.springframework.test.context.ActiveProfiles
import org.springframework.test.context.jdbc.Sql
import org.springframework.test.context.jdbc.SqlConfig
import org.springframework.test.web.reactive.server.WebTestClient


@Sql(scripts = ["/schema.sql", "/delete.sql"], config = SqlConfig(dataSource = "pgMockDataSource"))
@Sql(scripts = ["/functions.sql"], config = SqlConfig(
    dataSource = "pgMockDataSource",
    separator = ";;"
))
@ActiveProfiles("test")
@SpringBootTest
class MockService {

    @Autowired
    lateinit var mockJdbi: Jdbi

    @Autowired
    lateinit var tManager: TransactionManager

    @Autowired
    lateinit var serviceUser: ServiceUser

    @Autowired
    lateinit var serviceHome: ServiceHome

    @Autowired
    lateinit var serviceTemplate: ServiceTemplate

    @Autowired
    lateinit var serviceChat: ServiceChat

    fun runTest(block: (TransactionManager) -> Unit) =
        mockJdbi.useTransaction<Exception> { handle ->
            try {
                block(tManager)
            } catch (e: Exception) {
                handle.rollback()
                throw e
            }
            handle.rollback()
        }


    val tName = fun(i: Int) = "TestUser$i"
    val tPhoneNumber = fun(i: Int) = (912912912 + i).toString()
    val tPassword = fun(i: Int) = "Test_password2023$i"
    val tRegion = 351

    fun insertTestUsers(serviceHome: ServiceHome, times: Int = 2): List<Token> {
        val list = mutableListOf<Token>()
        var i = 1
        repeat(times) {
            list.add(
                serviceHome.signIn(
                    tName(i), tPhoneNumber(i),
                    tRegion, tPassword(i)
                )
            )
            i++
        }
        return list
    }


}


@Sql(scripts = ["/schema.sql", "/delete.sql", "/template.sql"], config = SqlConfig(dataSource = "pgMockDataSource"))
@Sql(scripts = ["/functions.sql"], config = SqlConfig(
    dataSource = "pgMockDataSource",
    separator = ";;"
))
@SpringBootTest(
    webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT
)
@ActiveProfiles("test")
@AutoConfigureWebClient
class MockController {
    @BeforeEach
    @Sql("/delete_ex_template.sql", config = SqlConfig(
        dataSource = "pgMockDataSource",
        transactionMode = SqlConfig.TransactionMode.ISOLATED
    ))
    fun setUp() = Unit

    @Autowired
    lateinit var webTestClient: WebTestClient


    fun registerUser(): ResponseCookie {
        val response = webTestClient.buildPost(
            Routes.Home.REGISTER,
            CreateUserInput.TEST, HttpStatus.CREATED
        )
        return response.getCookie("token")!!
    }


    fun registerUsers(times: Int): MutableList<Pair<ResponseCookie, String>> {
        val list = mutableListOf<Pair<ResponseCookie, String>>()
        var count = 1
        repeat(times) {
            val user = CreateUserInput.generate(count)
            val response = webTestClient.buildPost(
                Routes.Home.REGISTER,
                user, HttpStatus.CREATED
            )
            count++
            list.add(Pair(
                response.getCookie("token")!!,
                makePhoneNumber(user.region, user.number)
            ))
        }
        return list
    }
}

val testContent = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8-CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgoKPHN2ZwogICB3aWR0aD0iMjAwbW0iCiAgIGhlaWdodD0iMTAwbW0iCiAgIHZpZXdCb3g9IjAgMCAyMDAgMTAwIgogICB2ZXJzaW9uPSIxLjEiCiAgIGlkPSJzdmc1IgogICBpbmtzY2FwZTp2ZXJzaW9uPSIxLjIuMiAoNzMyYTAxZGE2MywgMjAyMi0xMi0wOSkiCiAgIHNvZGlwb2RpOmRvY25hbWU9ImRlc2VuaG8uc3ZnIgogICB4bWxuczppbmtzY2FwZT0iaHR0cDovL3d3dy5pbmtzY2FwZS5vcmcvbmFtZXNwYWNlcy9pbmtzY2FwZSIKICAgeG1sbnM6c29kaXBvZGk9Imh0dHA6Ly9zb2RpcG9kaS5zb3VyY2Vmb3JnZS5uZXQvRFREL3NvZGlwb2RpLTAuZHRkIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnN2Zz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgogIDxzb2RpcG9kaTpuYW1lZHZpZXcKICAgICBpZD0ibmFtZWR2aWV3NyIKICAgICBwYWdlY29sb3I9IiNmZmZmZmYiCiAgICAgYm9yZGVyY29sb3I9IiMwMDAwMDAiCiAgICAgYm9yZGVyb3BhY2l0eT0iMC4yNSIKICAgICBpbmtzY2FwZTpzaG93cGFnZXNoYWRvdz0iMiIKICAgICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMC4wIgogICAgIGlua3NjYXBlOnBhZ2VjaGVja2VyYm9hcmQ9IjAiCiAgICAgaW5rc2NhcGU6ZGVza2NvbG9yPSIjZDFkMWQxIgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJtbSIKICAgICBzaG93Z3JpZD0iZmFsc2UiCiAgICAgaW5rc2NhcGU6em9vbT0iMS40OTEyODc5IgogICAgIGlua3NjYXBlOmN4PSI0OTIuMTkyMDIiCiAgICAgaW5rc2NhcGU6Y3k9IjIwNy44NzQwMiIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjE5MjAiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iMTAxNyIKICAgICBpbmtzY2FwZTp3aW5kb3cteD0iMTkxMiIKICAgICBpbmtzY2FwZTp3aW5kb3cteT0iLTgiCiAgICAgaW5rc2NhcGU6d2luZG93LW1heGltaXplZD0iMSIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiIC8-CiAgPGRlZnMKICAgICBpZD0iZGVmczIiIC8-CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iQ2FtYWRhIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDojMDAwMDAwO3N0cm9rZS13aWR0aDowLjI2NDU4MyIKICAgICAgIGlkPSJwYXRoMjA3IgogICAgICAgZD0ibSAxOS4xNDA2NywzMC42NDA5MjcgYyAtMC4wMTM2NCw0LjI3NzY4IC0wLjEyNDAxLDguNTUzNSAtMC4wOTYxNiwxMi44MzE2MzMgMC4wMDM2LDAuMzkzMzggMC4wMDg0LDIuODk1OTA5IDAuMDc1MzksMy40NDQ1NjUgMC4wMzg3MywwLjMxNzI1NCAwLjA1NjksMC42NjcwMDQgMC4yNDE0ODksMC45Mjc5MTggMC4xMjg2ODcsMC4xODE4OTYgMC4zODc5MDEsMC4yOTkxNzcgMC42MDkzNzEsMC4yNzQ3NCA0Ljk4NjczNywtMC41NTAyMjIgMy44MjIwMDYsMC4xNDM4MjUgNi4wNjE4NDQsLTIuMjU3NDE3IDEuNjY2MjYyLC0xLjc5NzQ2MiAzLjQ1OTg0LC0zLjQ4NjQxNCA1LjQwNzMxMSwtNC45NzgxNDggMC41NTE3NDksLTAuNDIyNjMgMS4wOTcyNjcsLTAuODYyOTcgMS43MDUwNDEsLTEuMjAwMDk1IDAuNDY4MjQ3LC0wLjI1OTcyOCAyLjAzNDAwNiwtMC41NTMxNTEgMS40OTkwOSwtMC41NzcxODggLTAuODEwMzYzLC0wLjAzNjQxIC0xLjU4MjIzMiwwLjM1ODYwMyAtMi4zNzMzNSwwLjUzNzkwNiAwLjM4OTU3NSwwLjQ1NzA2MiAwLjg1MDI3OSwwLjg2MjAwNCAxLjE2ODcyMywxLjM3MTE4NyAwLjc1ODkwNCwxLjIxMzQ2NiAxLjI5NzQ3NCwyLjkzNzQwNyAxLjY1NzksNC4yOTYwMDUgMC41MTI3MDUsMS45MzI1OTkgMC43NzE3NjYsMy44NzcxNzUgMC45NzM3NjUsNS44NTkxNjYgMCwwIDMuNjY5NDE2LC0wLjA0NTYgMy42Njk0MTYsLTAuMDQ1NiB2IDAgYyAtMC4yOTM1MjksLTEuOTg3ODIgLTAuNjIxMTIyLC0zLjk2ODc2OSAtMS4xMjY0MjksLTUuOTE2NTMzIC0wLjM1NTQ3NiwtMS4zNzAyMjQgLTAuODc2MTg5LC0zLjE2NTA2NSAtMS41NTQ2MjUsLTQuNDMwODUzIC0wLjMwMTgwMywtMC41NjMwODYgLTAuNzMxMDU3LC0xLjA0NzkzIC0xLjA5NjU4NywtMS41NzE4OTUgLTEuNjU4ODM3LC0wLjE3NTk5IC0zLjMwODc2OCwtMC41NjQ2NzMgLTQuOTc2NTA4LC0wLjUyNzk2NSAtMC43NTUwODQsMC4wMTY2MiAtMi42NjIwNTgsMS41OTEwNzcgLTMuMDQ1NjAzLDEuODk4NTQ5IC0xLjkzNjU1MiwxLjU1MjQ1NiAtMy43NTA5NTEsMy4yNTQxNTggLTUuNTExMTA2LDUuMDAxNDgyIC0yLjM5MzQ2NCwyLjIyNjUwOSAtMS42Nzg1NjksMC44MjcwMDMgMS4zNzM1NjEsMS45NjU4NTIgMC4yMDQxMTMsMC4wNzYxNiAtMC40NDc3NSwwLjI5NTA5MiAtMC42Mjk2NTcsMC4xNzUyMDcgLTAuMjUwNjA5LC0wLjE2NTE2NiAtMC4yOTU2NTQsLTAuNTMyNTg4IC0wLjM1ODA2LC0wLjgyNjE2NyAtMC4xMjUzMzUsLTAuNTg5NjE2IC0wLjIwNTM5NSwtMi45NzYxNjggLTAuMjI1OTk3LC0zLjQyNjE0NyAtMC4xMDMxNTQsLTQuMjcyNDA1IC0wLjA3OTc2LC04LjU2MjE3OSAwLjQ1MzIwNSwtMTIuODA5MjQ5IDAsMCAtMy45MDIwMjIsLTAuMDE2OTYgLTMuOTAyMDIyLC0wLjAxNjk2IHoiIC8-CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtzdHJva2Utd2lkdGg6MC4yNjQ1ODMiCiAgICAgICBpZD0icGF0aDIwOSIKICAgICAgIGQ9Im0gNDEuNzIyNDI4LDUxLjM3ODA5MyBjIDIuMzgzMjk4LC0xLjkwMjg1NCA0LjUzMDgxNSwtNC4wOTYxNDcgNi40MDY2NTgsLTYuNTAwOSAwLjUwNzYzNSwtMC42NTA3NjQgMC45Njk3NDgsLTEuMzM1Nzg5IDEuNDU0NjIxLC0yLjAwMzY4NCAwLjkxMDM4MSwtMS40ODkzNjQgMS45MzQ1NjcsLTMuMDY0MzU5IDIuMDYzOTE3LC00Ljg2NTg5MSAwLjAyNTkzLC0wLjM2MTE5NCAwLjAxNTk1LC0wLjczODE3NSAtMC4wOTc4MiwtMS4wODE5NTggLTAuMDg3MzMsLTAuMjYzODc3IC0wLjIwOTYzMiwtMC42MzkyNDIgLTAuNDg0ODA2LC0wLjY3ODQ0IC0xLjU1NzEsLTAuMjIxODEzIC0zLjE0NTM2MiwtMC4wNDE4MSAtNC43MTgwNDIsLTAuMDYyNzIgLTAuMzgwMDI5LDAuMjY1OTMzIC0wLjc5NDAyMywwLjQ4ODk2MSAtMS4xNDAwOSwwLjc5Nzc5OCAtMS45MTYzOSwxLjcxMDIyNyAtMy4zNzQyOTIsNC4zODk4NDUgLTMuNDI0MTA4LDYuOTk0NjIxIC0wLjAxMjQ0LDAuNjQ5NjEyIDAuMTYyNjc0LDEuMjg5MjQgMC4yNDQwMTIsMS45MzM4NiAwLjU4NTUxOCwxLjMwNzEyNyAwLjczMjc1OSwyLjEyNDUzNiAxLjk3NDMxMSwyLjk4NzM0NCAwLjUxNDMyMywwLjM1NzQyMyAxLjEwMzAxNiwwLjY3NjUzNyAxLjcyNTc5NSwwLjc0MzA3NyAzLjA5NDI1NywwLjMzMDYgNS4zMDUzNjQsMC41ODU3NDMgNy44ODg4MzUsLTAuODAwNDk2IDAuODI5ODI4LC0wLjQ0NTI3IDEuNTQ4NTMyLC0xLjA3MjE3NCAyLjMyMjc5OCwtMS42MDgyNiAwLjc1MDAzNSwtMC44ODY3NzQgMS41Njg2MTEsLTEuNzE5ODUyIDIuMjUwMTA2LC0yLjY2MDMyNCAyLjIyNDI3NiwtMy4wNjk1MjcgMy43MDQyMDksLTYuNTM1NjM3IDQuNzQ4NjA3LC0xMC4xNjAwMDggMC43MDI0NzIsLTIuNDM3Nzk0IDAuNzcwOTA5LC0zLjI0OTIyNiAxLjE2MjMzMywtNS42MzUxNzggMC4wNDkxNSwtMC44MTMzNSAwLjI5NzY0OSwtMi41MTk5MzMgLTAuMTAwMTksLTMuNDA4OTUyIC0wLjExNTk0LC0wLjI1OTA4IC0wLjM2NzIxNywtMC41NzYwNCAtMC42NDk4NzcsLTAuNTUwMjE0IC0xLjY4MDA3LDAuMTUzNTA0IC0zLjUwMTU5MSwwLjE5NDMyIC00Ljk0ODU4NywxLjA2MTczMyAtMC43MDY0MDMsMC40MjM0NiAtMi45ODg5NzYsNi42MTU0NjkgLTMuMDIyNyw2LjcwMDc1MyAtMC44Njk4MTgsMy4wMzQ1NTEgLTEuNzI1MDYsNS4zMTEyNjkgLTEuODY3MjYzLDguNDg1ODA5IC0wLjA4NjMzLDEuOTI3MzQ0IDAuMDQ3ODMsNC40NzkwNjUgMS42OTUxNTcsNS45MTA5MzEgMC42ODQyODQsMC41OTQ3ODQgMS42MjE2MzEsMS4wNDMyNTMgMi41Mjc0NzIsMS4wMDQ5ODEgMi4zNTY2ODMsLTAuMDk5NTcgNC42MjM2NzgsLTAuOTM2NTIyIDYuOTM1NTE0LC0xLjQwNDc4MiAxLjI3NTI0NCwtMC45ODAxMzMgMi42NTUwODQsLTEuODM3NDUyIDMuODI1NzMzLC0yLjk0MDM5OSAxLjMxMzM3NSwtMS4yMzc0MTkgMi40NzgxMjEsLTIuNjMwMzA4IDMuNTkyOTM4LC00LjA0OTIzNCAyLjEyNjczNywtMi43MDY4OTEgMy43NjExNzEsLTUuNDc3OTMzIDUuMzQ4Nzg1LC04LjUxMjY0OCAwLjYwNDY2NSwtMS4xNTU4MTYgMS4xNzI5MjIsLTIuMzMyMDg4IDEuNjg3NzY5LC0zLjUzMDYxNiAwLjM4NTIzMSwtMC44OTY3ODkgMC42NzMwMzQsLTEuODMyMzY3IDEuMDA5NTQ5LC0yLjc0ODU1MSAwLjA5NDIzLC0wLjU1NjI3NSAwLjM2MTIwNCwtMS4xMTAxMTIgMC4yODI3LC0xLjY2ODgyNCAtMC4wMzQ2NiwtMC4yNDY3MDUgLTAuMzM3NTQ1LC0wLjUxMDkxOCAtMC41ODI5MDYsLTAuNDY3NzY0IC0xLjc2NDU0MSwwLjMxMDM0NiAtMy42NTQ5MjUsMC41MTg2NSAtNS4xNjczNDcsMS40NzkxMTUgLTAuOTkyMjgzLDAuNjMwMTQ5IC0xLjI5NDE1OSwxLjk2NDk5MSAtMS44Njk4MjcsMi45ODk4NDIgLTEuOTk5NjQxLDMuNTU5OTMyIC0yLjE3Nzc2MSw0LjMzMDg3MiAtMy43NDQ4NTQsOC4xNDQyNjcgLTAuMzk5ODgzLDEuMzk1MjgzIC0wLjkxNzM5OCwyLjc2MjA5OSAtMS4xOTk2NTUsNC4xODU4NDYgLTAuMjU0MzEsMS4yODI3NzkgLTAuMzQ3Nzc5LDIuNTk1ODUxIC0wLjQwMzgyOCwzLjkwMjM5MiAtMC4xMTM3NzYsMi42NTIxODYgMC4yMTE5MTgsNS4zNTY3NzggMS4wMDA2Miw3Ljg5MjYwMyAwLjE0ODg5NCwwLjQ3ODcyNCAwLjM1NjIwOCwwLjkzNzI4NCAwLjUzNDMxMiwxLjQwNTkyNyAwLjE1OTI3MiwwLjMxMzYgMC4zMTg1NCwwLjYyNzE5NyAwLjQ3NzgxMSwwLjk0MDc5OCAwLDAgMy43ODM0OTQsLTAuMTk1ODU2IDMuNzgzNDk0LC0wLjE5NTg1NiB2IDAgYyAtMC4xODg0NywtMC4yOTc3MDYgLTAuMzc2OTQxLC0wLjU5NTQxIC0wLjU2NTQxMiwtMC44OTMxMTQgLTAuMjEyNjA2LC0wLjQ1MzY5NyAtMC40NTY2MjgsLTAuODkzOTYxIC0wLjYzNzgyLC0xLjM2MTA5MyAtMC45NTIwMjQsLTIuNDU0NDM5IC0xLjQwOTc0MiwtNS4xMjc2MDEgLTEuMzcyOTE4LC03Ljc1OTQ4OSAwLjAxNzk5LC0xLjI4NjIxMyAwLjA4MzExLC0yLjU4MDg0NiAwLjMxNDcyNSwtMy44NDYxNjMgMC4yNTg0NjEsLTEuNDExOTkxIDAuNzY1OTk1LC0yLjc2NjgzMiAxLjE0ODk5MywtNC4xNTAyNDkgMS41MTYyOTgsLTMuNTkzODI3IDEuODM3NDA3LC00Ljc5NDM0MiAzLjk0Mjg4NywtOC4wNjgxNTYgMC42NTMxNDUsLTEuMDE1NTc2IDIuMTk3NDQ0LC0xLjY4ODA1NSAyLjE3Njg5MywtMi44OTUzNTQgLTAuMDE0NjgsLTAuODYyNTY1IC0xLjYwMzE2OCwtMC43MDkzMzEgLTIuMjQ4MDA1LC0xLjI4MjQxMSAtMC40MjE5NjMsLTAuMzc1MDA3IDQuMzc3NTQ0LDAuMjkyMjg5IDAuNzA5NTExLDEuNTM3NzY5IC0wLjI3MDEwNSwwLjkwNjkzNSAtMC40NzkyMjksMS44MzQzMTEgLTAuODEwMzE1LDIuNzIwODAyIC0wLjg3NDI5MiwyLjM0MDk0NiAtMi40NTQ4NTcsNS41NjYxNCAtMy43MjYxMTksNy42MzE2IC0xLjgyODc1NSwyLjk3MTIzMSAtNC4wNjI5ODQsNS45OTE5MTggLTYuNjkyODg5LDguMzE1OTQ0IC0xLjIyNzc5NywxLjA4NDk5MiAtMi42NzY4MTksMS44OTAzNDQgLTQuMDE1MjI3LDIuODM1NTE1IC0wLjM1NjMwMSwxLjYzMzMwNSAtMC4wOTY3LDIuNjIzMzI4IC0yLjgyMzA4NiwwLjU5MzAzNSAtMS43NDMyNzMsLTEuMjk4MTg0IC0yLjAwNDYwNywtMy43NDY4MjYgLTEuOTcwMjc4LC01LjY3MTcyNSAwLjA1ODQxLC0zLjI3NTE2OCAwLjkxNDM1LC01LjI5MDc1OSAxLjg1NDY4NCwtOC40MDQwNCAwLjU4NDY1NiwtMS4yODUzNjkgMS4wNzkwMjksLTIuNjE1NzYgMS43NTM5NjMsLTMuODU2MTA2IDAuNTA5NDI5LC0wLjkzNjE5MyAyLjAwMzkyOCwtMS42MDc4ODkgMS43ODcxMDcsLTIuNjUxNDI0IC0wLjE4NDQyOCwtMC44ODc2MjYgLTEuNzA0NDA5LC0wLjYyMDY1MiAtMi41NDAwMjQsLTAuOTcyMjc1IC0wLjIzODgwNSwtMC4xMDA0ODggMC41OTU3MTIsMC4wMDY2IDAuNzQ2MjIsMC4yMTc0NTEgMC41MTQ1NDEsMC43MjA5NTUgMC4zMzg4ODksMi42NDQxNjkgMC4zMzY3MTQsMy4yODMyMDYgLTAuMjgxNzI4LDIuMzU5MDA5IC0wLjMwMTQsMy4xNzEyNDYgLTAuOTUxMjYxLDUuNTgxMjU5IC0wLjk2OTUyNiwzLjU5NTQ3NiAtMi40NzA3OTEsNy4wNjMzMDMgLTQuNzY2NTMyLDEwLjAyMzk5NiAtMC43MTMzMDcsMC45MTk5MTEgLTEuNTgyNjU5LDEuNzA3NDQ2IC0yLjM3Mzk4OCwyLjU2MTE2OSAtMC43OTkxODIsMC41MDM4NzUgLTEuNTQ0MzA0LDEuMTA1OTc0IC0yLjM5NzU0OCwxLjUxMTYzMSAtMC43MjU0NzQsMC4zNDQ5MTEgLTEuNzM0NzU0LDAuMTUwMDExIC0yLjI5OTM1MywwLjcyMTQxMyAtMC4zNTM3NDgsMC4zNTgwMTMgMS42NzgyNDksMC41NTMyNDEgMS41MDc3OTEsMC4wNzk2OSAtMC4yMDI0MTEsLTAuNTYyMzM1IC0xLjE4MTYwMywtMC4yODE4NTUgLTEuNjkyMzA3LC0wLjU5MjI5NCAtMS4yMzQ0NzcsLTAuNzUwMzk1IC0xLjM5NjA5NSwtMS41MzE1ODMgLTEuOTk0ODQ3LC0yLjc1MjYxNiAtMC4wODg1NCwtMC42MDk2NDUgLTAuMjcxOTQ5LC0xLjIxMjkyNyAtMC4yNjU1OTksLTEuODI4OTM1IDAuMDI1OCwtMi41MDIzNzQgMS41MjQ5OTIsLTUuMjAyNzU5IDMuNTMyMDc0LC02LjY2ODEzIDAuMzY1Mjg5LC0wLjI2NjY5NyAwLjgwNjA3MSwtMC40MTA0OTMgMS4yMDkxMDgsLTAuNjE1NzQxIC0wLjk2NDgzMiwtMC4wNzMwNyAtMS45MzEyMTcsLTAuMzEwNDkzIC0yLjg5NDQ5NiwtMC4yMTkyMTUgLTAuMjI5MzU0LDAuMDIxNzIgMC40MjkwMjcsMC4yMzYzMTUgMC41MzAzMDEsMC40NDMyNDMgMC4xNDQwMTEsMC4yOTQyNTEgMC4xNjU3MjgsMC42NDE5MzggMC4xNjExMjQsMC45Njk1MDggLTAuMDI0NCwxLjczNTMwMSAtMC45OTI3NDMsMy4yNzMwNjggLTEuODM1MjY5LDQuNzExMjAyIC0wLjQ3NTU3NiwwLjY1OTcwNCAtMC45MjMyNzIsMS4zNDA0MyAtMS40MjY3MjQsMS45NzkxMTUgLTEuOTI3NTg0LDIuNDQ1MzYxIC00LjIxMjk3OCw0LjY4MTM0MiAtNi44Njc4NSw2LjMyNDk2NSAwLDAgMy45MzM4MjIsMC40MjAwMjQgMy45MzM4MjIsMC40MjAwMjQgeiIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDojMDAwMDAwO3N0cm9rZS13aWR0aDowLjI2NDU4MyIKICAgICAgIGlkPSJwYXRoMjExIgogICAgICAgZD0ibSA3OC42MzMxNjYsNDIuNjUxOTg0IGMgLTEuNzk0OTcxLDAuOTYwNTQ4IC0zLjU4NTAxMiwyLjM0Mjg5NiAtNC43NzY2OTgsNC4wMDcxODYgLTAuMzgwNzI3LDAuNTMxNzIgLTAuNzQwMjg4LDEuMDk0NTcgLTAuOTYyMzExLDEuNzA5NyAtMC4xOTUzNDIsMC41NDEyMTkgLTAuMTgwMDgzLDEuMTM2NjAzIC0wLjI3MDEyNiwxLjcwNDkwNCAwLjIyMTA4MywwLjUwNDc1NiAwLjMxMDIxMywxLjA5MTE2IDAuNjYzMjUsMS41MTQyNjggMC44MjQ2ODIsMC45ODgzNyAyLjE2NjY0OSwxLjQxMzY0OCAzLjQwNDE5LDEuNDE1Njg4IDEuODU0NjYsMC4wMDMxIDMuNzMwNDY4LC0wLjAwODggNS41NTI3MDQsLTAuMzU0MDg5IDEuMzc3MTQsLTAuMjYwOTU0IDIuMTkxOTAxLC0xLjU3NDIzMiAyLjk4NjM0OSwtMi41MjQ3MjkgMC4yNTI2MDEsLTAuNTUxNjM1IDAuNTY0MjE2LC0xLjA3OTg5NyAwLjc1NzgwMSwtMS42NTQ5MDIgMC40OTg0MDcsLTEuNDgwNDM3IDAuNjcwNjIxLC0zLjYxNjM2OCAtMC4zMTQyNzIsLTQuOTU5OTc1IC0wLjE1NjUzNSwtMC4yMTM1NDcgLTAuMzg2MTY0LC0wLjM2MjM1MiAtMC41NzkyNDcsLTAuNTQzNTMgLTAuMjI1MTg2LC0wLjA5MDU2IC0wLjQ1MDM3MSwtMC4xODExMjYgLTAuNjc1NTU4LC0wLjI3MTY4OCAwLDAgLTMuODI3NjI2LDAuNDk1MzQyIC0zLjgyNzYyNiwwLjQ5NTM0MiB2IDAgYyAwLjIyMzI2MywwLjA0MDI1IDAuNDQ2NTI3LDAuMDgwNSAwLjY2OTc5MywwLjEyMDc0OCAwLjE5OTUxNCwwLjEzMjkyNCAwLjQzMzU4MywwLjIyNDgxMiAwLjU5ODU0NSwwLjM5ODc3NSAxLjA3NjUyMSwxLjEzNTI2OSAwLjkzODM0NSwzLjI0OTY3OSAwLjQ4NjE5Niw0LjYwMjUwMSAtMC4xODEzODIsMC41NDI2ODcgLTAuNDg0MjUxLDEuMDM2ODg2IC0wLjcyNjM3NCwxLjU1NTMyOSAtMC40MDgzNzksMC40NTgxMDUgLTAuNzQwNDcxLDAuOTk3ODQyIC0xLjIyNTEzNywxLjM3NDMxOCAtMC41MTAwMjcsMC4zOTYxNzYgLTEuNjQ3ODM4LDAuMjY0NTIgLTEuNzExOTYzLDAuOTA3MTQ3IC0wLjA1Mzc1LDAuNTM4NjM3IDIuMDgxNTk2LDAuMTIzMzg5IDEuNTg3MTQ2LDAuMzQzNyAtMC41NzM5LDAuMjU1NzExIC0xLjI3NDY5OSwtMC4wMjI4OSAtMS44NzIzODUsLTAuMjE2NjA3IC0xLjUyNTgzOSwtMC40OTQ1MTEgLTEuNDQ5Nzg3LC0wLjg5Nzc3NCAtMi4xMDU3MjYsLTIuMTQ4NjQxIDAuMDcwODksLTAuNTIzOTkyIDAuMDM0NCwtMS4wNzQxNjYgMC4yMTI2NjQsLTEuNTcxOTc3IDAuNzYyOTQ3LC0yLjEzMDU1OCAzLjE4ODcwMywtNC4wMjg4OTggNS4xMzIwNjIsLTUuMDQ4MDQxIDAuMjg5NDM2LC0wLjE1MTc4NiAwLjYwMDExMiwtMC4yNTkwNjQgMC45MDAxNjgsLTAuMzg4NTk2IDAsMCAtMy45MDM0NDUsLTAuNDY2ODMxIC0zLjkwMzQ0NSwtMC40NjY4MzEgeiIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDojMDAwMDAwO3N0cm9rZS13aWR0aDowLjI2NDU4MyIKICAgICAgIGlkPSJwYXRoMjEzIgogICAgICAgZD0ibSAxMTMuMDQ0MzIsNjAuODgxODM5IGMgMC40MjY4Miw1LjIzNTc4MSAtMC4zNDA5NywtNC4zMzY3MDYgMC4yMzg5NCwzLjcxODUxMiAwLjA4NjksMS4yMDY5MSAwLjIwNTMxLDIuNDExMzQ5IDAuMzAyMjcsMy42MTc0OTIgMC4zMDE0LDMuNzQ4OTA3IDAuNTcwNiw3LjQ5OTkwOCAwLjgyNjU2LDExLjI1MjEzMyAwLjA0NDUsMC43OTE5OCAwLjA4OSwxLjU4Mzk2IDAuMTMzNDgsMi4zNzU5NCAwLDAgMy41MjE5NSwtMC4wMzI4NSAzLjUyMTk1LC0wLjAzMjg1IHYgMCBjIC0wLjEwMzU0LC0wLjc5MDgyOSAtMC4yMDcwOCwtMS41ODE2NTUgLTAuMzEwNjIsLTIuMzcyNDg0IC0wLjY2NTc1LC02LjE2NTA4OCAtMS4xOTk0OCwtMTIuMzY4OTAzIC0wLjgyMzMsLTE4LjU3MzcgMCwwIC0zLjg4OTI4LDAuMDE0OTUgLTMuODg5MjgsMC4wMTQ5NSB6IiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjAuMjY0NTgzIgogICAgICAgaWQ9InBhdGgyMTUiCiAgICAgICBkPSJtIDk0Ljg2MjYxNCw2OC4xMjA1MSBjIDUuNDExNTI2LC0xLjY0NTQ1OSAxMC44NTQyMTYsLTMuMTkwNDcgMTYuMzUwNTA2LC00LjUyOTk2MiAxLjg4MzY3LC0wLjQ1OTA2OCAzLjc3NzM5LC0wLjg3NTkyNSA1LjY2NjA4LC0xLjMxMzg4NCA1LjQ1MzAyLC0xLjIxNjE0NyAxMC45Mzc2NSwtMi4yNzkwMDcgMTYuNDU1ODcsLTMuMTUwMDM5IDAsMCAtMy40MTgzMywtMC40ODI4MzkgLTMuNDE4MzMsLTAuNDgyODM5IHYgMCBjIC01LjMwNTY3LDAuOTYxNzk4IC0xMC41ODA1NCwyLjA3OTQ0MyAtMTUuODQzMTYsMy4yNTM2NjQgLTEuODk5NTcsMC40MzgzMTkgLTMuODAyNTIsMC44NjIyNzcgLTUuNjk4NzIsMS4zMTQ5NiAtNS44MjUwNSwxLjM5MDYyOSAtMTEuNjA3NDQ0LDIuOTUwNzQ3IC0xNy40MTc0NDMsNC40MDA1MjQgMCwwIDMuOTA1MTk3LDAuNTA3NTc2IDMuOTA1MTk3LDAuNTA3NTc2IHoiIC8-CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtzdHJva2Utd2lkdGg6MC4yNjQ1ODMiCiAgICAgICBpZD0icGF0aDIxNyIKICAgICAgIGQ9Im0gMTI2LjkzOTE5LDc5LjI1NDMzMyBjIDMuMjAyNDYsLTEuODQxOTkyIDYuMDY0MDMsLTQuMjMxMzk2IDguNjE5NTgsLTYuODkwMjIxIDAuNTkyNTYsLTAuNjE2NTEzIDEuMTQyNDgsLTEuMjcyNjQ2IDEuNzEzNzIsLTEuOTA4OTY2IDAuNDE3MjcsLTAuNTU3MzQ1IDAuODc2ODIsLTEuMDg1NDA4IDEuMjUxODEsLTEuNjcyMDM0IDAuMzg1NTMsLTAuNjAzMTE4IDAuOTQzMTYsLTEuNjA3MzY4IDAuODY3NCwtMi40MTY5NTMgLTAuMTQ0MzIsLTEuNTQyMDc5IC0zLjY2OTQsLTAuNjk3NjMgLTQuODI4ODEsLTAuNDUzMjkyIC0wLjM5ODYyLDAuMDg0MDEgLTAuNDgyODIsMC42NTYyOTkgLTAuNzI0MjMsMC45ODQ0NDggLTAuMjE0NiwwLjQ2ODI4MSAtMC40NzQ4OSwwLjkxODIxMyAtMC42NDM4MiwxLjQwNDg0IC0wLjUzMDYxLDEuNTI4NTE2IC0wLjcwODc1LDMuMjExNzUzIC0wLjI5MDM5LDQuNzkwNzkyIDAuMjk0MTksMS4xMTA0MzUgMC41NTE3OCwxLjMyMDY3MyAxLjE3ODM0LDIuMjE1MTA1IDEuMzQzMTQsMS40Njg4NiAyLjc4MjE2LDEuNzc5NzExIDQuNjQ1MTcsMi4xMjc5NTMgMCwwIDMuODIwMjUsLTAuNTM4Mzg3IDMuODIwMjUsLTAuNTM4Mzg3IHYgMCBjIC0xLjMzODg1LC0wLjIxMTg0NyAtMi43ODQ5NywtMC40MDM0ODIgLTMuOTMwNjIsLTEuMTkwMDc1IC0wLjI3NjMzLC0wLjE4OTcyNCAtMC41MTYzNSwtMC40Mjc1NDMgLTAuNzc0NTIsLTAuNjQxMzEzIC0wLjY0MTM3LC0wLjgwMTM2NyAtMC45MTc1MywtMS4wMDA0ODcgLTEuMjM0NjEsLTIuMDM0NTg3IC0wLjQ1NzUxLC0xLjQ5MjAzNiAtMC4yOTU0OSwtMy4xMjIwODEgMC4yNzg3LC00LjU1ODUzOCAwLjE4NDAxLC0wLjQ2MDMyMiAwLjQ3MjYyLC0wLjg3MTU3NyAwLjcwODkzLC0xLjMwNzM2NSAxLjQ2Njg1LC0xLjQyNDYzMyAxLjQ0NzYxLC0xLjAxMDMzIC0yLjM5Njg4LC0xLjEwMjM2NSAtMC4xNTU2NSwtMC4wMDM3IDAuMzQzODYsMC4xMTE3MTIgMC4zODcxNywwLjI2MTI1NSAwLjA4MzksMC4yODk0OTEgMC4wMzM1LDAuNjEzMjA5IC0wLjA1LDAuOTAyNzgyIC0wLjM0NTI4LDEuMTk2NDQxIC0xLjAzNTMxLDEuOTU5NzU2IC0xLjc0NjgxLDIuOTc1MTg3IC0wLjU0NzY3LDAuNjI5NjEzIC0xLjA2Nzk1LDEuMjg0MTQyIC0xLjY0MzAyLDEuODg4ODM2IC0yLjM3MzQ4LDIuNDk1NzcgLTUuMDk1ODgsNC42NTUxOTEgLTguMTQ5NTQsNi4yNTkxMjkgLTAuMzE1ODUsMC4xNjU4OTYgLTAuNjUwMTYsMC4yOTM5NiAtMC45NzUyMywwLjQ0MDk0MSAwLDAgMy45MTc0MywwLjQ2MjgyOCAzLjkxNzQzLDAuNDYyODI4IHoiIC8-CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtzdHJva2Utd2lkdGg6MC4yNjQ1ODMiCiAgICAgICBpZD0icGF0aDIxOSIKICAgICAgIGQ9Im0gMTU0LjIwOTgsNjQuNjEwOTk1IGMgLTIuMzAwODMsLTAuMDY3NjIgLTQuNTM2NTQsLTAuMzE5NjAxIC02LjcwMTUsMC40ODYzOTcgLTAuNTUyOSwwLjIwNTg0MyAtMS41MzUyMiwwLjY0MjkxMSAtMS45NDUzMSwxLjEyODE5NiAtMC4xOTcsMC4yMzMxMjIgLTAuMjU1NjEsMC41NTQzMzIgLTAuMzgzNDIsMC44MzE0OTYgMC4xNTg0MiwwLjM1NTM5OSAwLjI1MTcxLDAuNzQ3NzEyIDAuNDc1MjYsMS4wNjYxOTcgMC40MDY4NSwwLjU3OTY0NCAxLjQ5OTM4LDEuNDE3MzkxIDIuMDM0OTYsMS44NDIyNyAwLjU1NDcyLDAuNDQwMDYzIDEuNDMyMzQsMS4wNzE0NDMgMS45NDMxNSwxLjU4NTc3NyAwLjIyMzQsMC4yMjQ5NDQgMC40MDE5MiwwLjQ5MDM4OSAwLjYwMjg4LDAuNzM1NTg0IDAuMDY2NiwwLjI0NDczNyAwLjIyNTQ1LDAuNDgxODU5IDAuMTk5ODgsMC43MzQyMTEgLTAuMDY0NiwwLjYzNzMzNiAtMC43OTY4NywxLjEzNDA0NiAtMS4yNjA5LDEuMzgzMTQ2IC0xLjUzNzU4LDAuODI1NDA1IC0zLjQ1MTk0LDEuMTM2NjQ1IC01LjE0MDIsMS40ODQ3MzQgLTAuNTYzNTEsMC4xMTM4MTggLTIuMDg2MjIsMC40MDgxMDMgLTIuNzI1MDIsMC41ODA1OCAtMC4wNzA0LDAuMDE5IC0wLjk4MDE3LDAuMTk0MDc3IC0wLjk4MDY1LDAuNTYxMjI0IC04ZS00LDAuNTM4ODg3IDAuNDI4NzksMC42ODM2MTEgMC43ODUzNCwwLjkxNDkyOSAwLDAgMy44NjM0NiwtMC40MTI2NzEgMy44NjM0NiwtMC40MTI2NzEgdiAwIGMgLTAuMTU4MjcsLTAuMDcxNDYgLTAuMzA3ODIsLTAuMTY2NzAzIC0wLjQ3NDgxLC0wLjIxNDM2NSAtMC4wNzk0LC0wLjAyMjY1IC0wLjIwMjQxLDAuMDc3MzEgLTAuMjQ3NTUsMC4wMDgyIC0wLjAzODksLTAuMDU5NSAwLjA5ODgsLTAuMTA3NTQgMC4xNjM2MSwtMC4xMzY3MDcgMC4yMDA5LC0wLjA5MDQxIDAuNDEyMDQsLTAuMTU3NzUzIDAuNjI0MDIsLTAuMjE3NzY4IDAuNjg3ODQsLTAuMTk0NzQ5IDEuOTQ3MjksLTAuNDUzMjYxIDIuNTg1MTksLTAuNTkxNDI5IDEuMjQ0ODcsLTAuMjc0NjIxIDIuNDg0MDYsLTAuNTA4MDA1IDMuNjg5MzEsLTAuOTM5NzAyIDEuMTA5NjUsLTAuMzk3NDU3IDIuODUyODYsLTEuMDY2MDgzIDIuOTQ3OTIsLTIuNTIwNTYzIDAuMDIwMSwtMC4zMDc2NjYgLTAuMTU4LC0wLjU5NjA1NiAtMC4yMzcsLTAuODk0MDg2IC0wLjIxNjgzLC0wLjI2NTk2NyAtMC40MDkyNywtMC41NTM4NDQgLTAuNjUwNSwtMC43OTc5MDEgLTEuMTgzOTMsLTEuMTk3ODA4IC0yLjgzMzI0LC0xLjk5NDk1NiAtMy45Mjc4NiwtMy4yODU1OTMgLTAuMTgwNTksLTAuMjEyOTI0IC0wLjI5MjM1LC0wLjQ3NTczNCAtMC40Mzg1MiwtMC43MTM2IDAuMTA5NTQsLTAuMjE0NTE2IDAuMTYyNDUsLTAuNDY5MTcgMC4zMjg2LC0wLjY0MzU1MSAwLjY3MzE1LC0wLjcwNjQ4NSAyLjE0MzkxLC0xLjExOTM4MSAzLjA2NDk1LC0xLjI4MTM0OCAwLjM0NTM5LC0wLjA2MDc0IDEuMzk2NjksLTAuMDg0NTIgMS4wNDY2OCwtMC4xMDYyMTQgLTEuMDQzNjgsLTAuMDY0NjkgLTIuMDkxMywtMC4wMTU1NiAtMy4xMzY5NSwtMC4wMjMzNCAwLDAgMy44OTQ5OCwtMC41NjQwODYgMy44OTQ5OCwtMC41NjQwODYgeiIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDojMDAwMDAwO3N0cm9rZS13aWR0aDowLjI2NDU4MyIKICAgICAgIGlkPSJwYXRoMjIxIgogICAgICAgZD0ibSAxNjAuODc1NTksNTYuNTEzNzAzIGMgLTAuMDAzLDMuNjQwMzIyIC0wLjIyNjA3LDcuMjc2MzQzIC0wLjI0MzA3LDEwLjkxNjY1OCAtMC4wMTU1LDMuMzI3NDcxIDAuMDUwNiw0LjEyNjk5NCAwLjE3OTM4LDcuMzc4MTA3IDAsMCAzLjI5Mzc5LC0wLjAxNjA5IDMuMjkzNzksLTAuMDE2MDkgdiAwIGMgLTAuMDY4MSwtMS4xNzA5MzIgLTAuMTY3LC0yLjM0MDQ3NSAtMC4yMDQxNywtMy41MTI3OTMgLTAuMTU2MTYsLTQuOTI0NTY1IDAuMTkxODUsLTkuODU1MTM3IDAuODc5OTMsLTE0LjczMDQ4NCAwLDAgLTMuOTA1ODYsLTAuMDM1NDEgLTMuOTA1ODYsLTAuMDM1NDEgeiIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDojMDAwMDAwO3N0cm9rZS13aWR0aDowLjI2NDU4MyIKICAgICAgIGlkPSJwYXRoMjIzIgogICAgICAgZD0ibSAxNTkuMjQ5Miw2Ny4xMjc1MzcgYyAyLjU1MDc5LC0xLjUxODc4NSA1LjMzMzc4LC0yLjU1MjkzIDguMTM2NTIsLTMuNDk0NjgzIDAuNDk4NzQsLTAuMTUyODIgMC45OTc0OCwtMC4zMDU2NDEgMS40OTYyMiwtMC40NTg0NTkgMCwwIC0zLjY2MDgzLC0wLjQ2NTQ4NCAtMy42NjA4MywtMC40NjU0ODQgdiAwIGMgLTAuNDgzNTQsMC4xNTc1NyAtMC45NjcwNywwLjMxNTE0IC0xLjQ1MDYsMC40NzI3MTIgLTEuMzk5NzUsMC40ODU3MzMgLTIuMDM5MDEsMC42OTAwNzkgLTMuNDI5MzIsMS4yNDU0MjMgLTEuNzAzODUsMC42ODA1ODggLTMuMzYxMTEsMS40NjczNjYgLTUuMDA2MzYsMi4yNzczMzIgMCwwIDMuOTE0MzcsMC40MjMxNTkgMy45MTQzNywwLjQyMzE1OSB6IiAvPgogIDwvZz4KPC9zdmc-Cg=="